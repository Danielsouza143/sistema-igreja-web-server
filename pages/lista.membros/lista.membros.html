<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="/auth-guard.js"></script>
    <title>Lista de Membros</title>
    <link rel="stylesheet" href="/pages/lista.membros/lista.membros.css"> <!-- Caminho já estava correto, confirmando -->
    <link rel="stylesheet" href="/pages/styles/global.css"> 
    <link rel="stylesheet" href="/components/menu.css">
    <link rel="stylesheet" href="/components/notifications.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <style>
        /* Estilo para o ícone de membro inativo */
        .status-inativo {
            color: #ffc107; /* Amarelo/Laranja para alerta */
            font-size: 0.9em;
            margin-left: 8px;
        }
    </style>
</head>
<body>
<header id="menu-placeholder"></header>
    <main class="conteudo">
        <div class="page-header-wrapper" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
            <h1 class="title-page" style="margin-bottom: 0;">Gerenciamento de Membros</h1>
            <div class="header-actions">
                <button class="btn-principal" onclick="window.location.href='../cadastro.membro.page/cadastro.membro.html'">+ Novo Membro</button>
                <button class="btn-secundario btn-relatorio"><i class='bx bxs-file-pdf'></i> Relatório</button>
                <button class="btn-secundario" id="btn-share-link" title="Copiar Link de Cadastro Público"><i class='bx bx-share-alt'></i> Link Público</button>
            </div>
        </div>

        <nav class="abas-navegacao">
            <button class="aba-link active" data-aba="lista">Lista de Membros</button>
            <button class="aba-link" data-aba="presenca">Controle de Presença</button>
            <button class="aba-link" data-aba="engajamento">Análise de Engajamento</button>
        </nav>

        <!-- Aba 1: Lista de Membros -->
        <div id="lista" class="aba-conteudo active">
            <div class="acoes-header">
                <div class="filtros-container">
                    <input type="text" id="filtro-nome" placeholder="Buscar por nome...">
                    <select id="filtro-genero"><option value="">Gênero</option><option value="homem">Homem</option><option value="mulher">Mulher</option></select>
                    <select id="filtro-cargo"><option value="">Todos os Cargos</option><option value="membro">Membro</option><option value="obreiro">Obreiro (Auxiliar)</option><option value="diacono">Diácono</option><option value="presbitero">Presbítero</option><option value="evangelista">Evangelista</option><option value="pastor">Pastor</option><option value="musico">Músico</option><option value="membra">Membra</option><option value="missionarioPastor">Missionária (Mulher de Pastor)</option><option value="missionariaPresbitero">Missionária (Mulher de Presbítero)</option><option value="diaconisa">Diaconisa</option></select>
                </div>
            </div>
            <div class="tabela-wrapper">
                <table class="tabela-dados">
                    <thead>
                        <tr>
                            <th>Foto</th>
                            <th>Nome</th>
                            <th>Status</th>
                            <th>Cargo</th>
                            <th>Telefone</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody class="membros-lista">
                        <!-- Conteúdo da lista de membros -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Aba 2: Controle de Presença -->
        <div id="presenca" class="aba-conteudo">
            <div class="presenca-header">
                <h2>Registrar Presença no Culto</h2>
                <div class="filtro-grupo">
                    <label for="data-culto">Selecione a data:</label>
                    <input type="date" id="data-culto">
                </div>
                <div class="filtro-grupo">
                    <label for="busca-presenca">Buscar membro:</label>
                    <input type="text" id="busca-presenca" placeholder="Nome ou telefone...">
                </div>
            </div>
            <div id="lista-presenca-container"></div>
            <div class="presenca-footer">
                <button id="btn-salvar-presenca" class="btn-principal" disabled>Salvar Presenças</button>
            </div>
        </div>

        <!-- Aba 3: Análise de Engajamento -->
        <div id="engajamento" class="aba-conteudo">
            <div class="ranking-wrapper">
                <h2><i class='bx bxs-star'></i> Ranking de Engajamento</h2>
                <p class="subtitulo-ranking">Membros com maior frequência nos cultos (últimos 3 meses).</p>
                <ol id="lista-ranking-engajamento">
                    <!-- Ranking será preenchido via JS -->
                </ol>
            </div>
        </div>
    </main>

    <!-- Modal de Compartilhamento -->
    <div id="modal-share" class="modal-overlay">
        <div class="modal-content share-modal-content">
            <button class="modal-close" id="btn-close-share">&times;</button>
            <div class="share-header">
                <div class="share-icon-circle">
                    <i class='bx bxs-share-alt'></i>
                </div>
                <h2>Compartilhar Cadastro</h2>
                <p>Envie este link para novos membros se cadastrarem.</p>
            </div>
            
            <div class="share-input-group">
                <input type="text" id="share-link-input" readonly>
                <button id="btn-copy-modal" title="Copiar Link"><i class='bx bx-copy'></i></button>
            </div>

            <button id="btn-native-share" class="btn-principal full-width-btn">
                <i class='bx bxl-whatsapp'></i> Compartilhar via App
            </button>
        </div>
    </div>

<script src="/js/global-loader.js" defer></script>

<script src="/js/api.js"></script>

<script src="/pages/lista.membros/lista.membros.js"></script> <!-- Caminho já estava correto, confirmando -->
</body>
</html>