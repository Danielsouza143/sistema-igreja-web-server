<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="/auth-guard.js"></script>
    <title>Gestão de Pequenos Grupos</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="../styles/global.css">
    <link rel="stylesheet" href="../../components/menu.css">
    <link rel="stylesheet" href="/components/notifications.css">
    <link rel="stylesheet" href="pequenos-grupos.css">
</head>
<body>
    
    <header id="menu-placeholder"></header>

    <main class="conteudo">
        <div id="view-painel">
            <div class="header-flex">
                <h1 class="title-page">Painel de Pequenos Grupos</h1>
                <button id="btn-novo-pg" class="btn-principal"><i class='bx bx-plus'></i> Novo Grupo</button>
            </div>
            <nav class="abas-navegacao">
                <button class="aba-link active" data-aba="painel-grupos">Grupos</button>
                <button class="aba-link" data-aba="analise-geral">Análise Geral</button>
            </nav>

            <div id="painel-grupos" class="aba-conteudo active">
                <div id="grid-pequenos-grupos" class="grid-pequenos-grupos">
                    <!-- Cards dos grupos serão inseridos aqui -->
                </div>
            </div>

            <div id="analise-geral" class="aba-conteudo">
                <section class="dashboard-resumo">
                    <div class="card-resumo"><h4>Total de Grupos</h4><span id="total-grupos">0</span></div>
                    <div class="card-resumo"><h4>Total de Membros</h4><span id="total-membros-pg">0</span></div>
                    <div class="card-resumo"><h4>Frequência Média</h4><span id="frequencia-media-pg">0%</span></div>
                </section>
                <section class="graficos-container">
                    <div class="grafico-wrapper">
                        <h2>Crescimento de Grupos</h2>
                        <div class="chart-canvas-container"><canvas id="grafico-crescimento-pg"></canvas></div>
                    </div>
                    <div class="grafico-wrapper">
                        <h2>Ranking de Frequência</h2>
                        <div class="chart-canvas-container"><canvas id="grafico-ranking-frequencia"></canvas></div>
                    </div>
                </section>
            </div>
        </div>

        <div id="view-detalhes-pg" style="display: none;">
            <!-- Conteúdo dos detalhes do grupo será carregado aqui -->
        </div>
    </main>

    <!-- Modal de Cadastro/Edição de Pequeno Grupo -->
    <div id="modal-pg" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close">&times;</button>
            <h2 id="modal-pg-titulo">Novo Pequeno Grupo</h2>
            <form id="form-pg">
                <div class="form-grid">
                    <div class="form-group span-2"><label for="pg-nome">Nome do Grupo*</label><input type="text" id="pg-nome" required></div>
                    <div class="form-group"><label for="pg-lider">Líder*</label><select id="pg-lider" required></select></div>
                    <div class="form-group"><label for="pg-anfitriao">Anfitrião</label><select id="pg-anfitriao"></select></div>
                    <div class="form-group"><label for="pg-dia-semana">Dia da Semana*</label><select id="pg-dia-semana" required><option>Segunda-feira</option><option>Terça-feira</option><option>Quarta-feira</option><option>Quinta-feira</option><option>Sexta-feira</option><option>Sábado</option><option>Domingo</option></select></div>
                    <div class="form-group"><label for="pg-horario">Horário*</label><input type="time" id="pg-horario" required></div>
                    <div class="form-group span-2"><label for="pg-cep">CEP (para buscar endereço)</label><input type="text" id="pg-cep" placeholder="00000-000"></div>
                    <div class="form-group span-2"><label>Endereço</label><input type="text" id="pg-logradouro" placeholder="Rua, Av..."></div>
                    <div class="form-group"><label>Bairro</label><input type="text" id="pg-bairro"></div>
                    <div class="form-group"><label>Cidade</label><input type="text" id="pg-cidade"></div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secundario" data-close>Cancelar</button>
                    <button type="submit" class="btn-principal">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Registrar Encontro -->
    <div id="modal-encontro" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close">&times;</button>
            <h2>Registrar Encontro</h2>
            <form id="form-encontro">
                <div class="form-group"><label for="encontro-data">Data do Encontro*</label><input type="date" id="encontro-data" required></div>
                <div class="form-group"><label for="encontro-tema">Tema do Estudo</label><input type="text" id="encontro-tema"></div>
                <div class="form-group"><label for="encontro-visitantes">Nº de Visitantes</label><input type="number" id="encontro-visitantes" min="0" value="0"></div>
                <div class="form-group">
                    <label>Membros Presentes</label>
                    <div id="lista-presenca-membros-pg" class="lista-presenca-pg">
                        <!-- Checkboxes dos membros serão inseridos aqui -->
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secundario" data-close>Cancelar</button>
                    <button type="submit" class="btn-principal">Salvar Encontro</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Detalhes do Encontro -->
    <div id="modal-detalhes-encontro" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close">&times;</button>
            <h2 id="detalhes-encontro-titulo">Detalhes do Encontro</h2>
            <div class="detalhes-encontro-grid">
                <div class="coluna-presenca">
                    <h3><i class='bx bxs-user-check'></i> Presentes</h3>
                    <ul id="lista-detalhe-presentes"></ul>
                </div>
                <div class="coluna-presenca">
                    <h3><i class='bx bxs-user-x'></i> Ausentes</h3>
                    <ul id="lista-detalhe-ausentes"></ul>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/global-loader.js" defer></script>
    <script src="/pages/config.js"></script>
    <script src="pequenos-grupos.js"></script>
</body>
</html>