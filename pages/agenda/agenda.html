<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- O Guardião deve ser o PRIMEIRO script a ser carregado -->
    <script src="/auth-guard.js"></script>

    <title>Agenda da Igreja</title>

    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    
    <link rel="stylesheet" href="/pages/styles/global.css">
    <link rel="stylesheet" href="/components/menu.css">
    <link rel="stylesheet" href="/pages/styles/tabelas-abas.css">
    <link rel="stylesheet" href="agenda.css">
    
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js'></script>
</head>
<body>

<header id="menu-placeholder">
    <nav class="menu">
    <div class="menu-lado-esquerdo">
        <div class="hamburger-menu hamburger-mobile" id="hamburger-btn-mobile">
            <i class='bx bx-menu'></i>
        </div>
        <img src="/pages/logo.tab.png" alt="logo-tab" width="65" class="menu-logo" />
        <h3>ADTC - Tabernáculo Celeste</h3>
    </div>
    <div class="menu-acoes">
        <div class="notificacao-container" id="notificacao-container">
            <i class='bx bxs-bell'></i>
            <span class="notificacao-contador" id="notificacao-contador"></span>
        </div>
        <div class="conta-area">
            <a href="#" class="link-conta">Minha Conta</a>
            <i class='bx bx-user-circle'></i>
        </div>
    </div>
</nav>

<aside class="sub-menu">
    <div class="hamburger-menu hamburger-desktop" id="hamburger-btn-desktop">
        <i class='bx bx-menu'></i>
    </div>
    <div class="menu-categorias">
        <a href="/pages/dashboard/dashboard.html" class="sub-menu-link">Dashboard</a>
        <a href="/pages/cadastro.page/cadastro.html" class="sub-menu-link">Cadastro</a>
        <a href="/pages/financeiro.page/financeiro.html" class="sub-menu-link">Financeiro</a>
        <a href="/pages/utensilios/utensilios.html" class="sub-menu-link">Utensílios</a>
        <a href="/pages/agenda/agenda.html" class="sub-menu-link">Agenda</a>
    </div>
</aside>

<div id="sidebar-overlay" class="sidebar-overlay"></div>
<nav id="sidebar-menu" class="sidebar">
    <div class="sidebar-header">
        <h4>Navegação Principal</h4>
        <i class='bx bx-x' id="sidebar-close-btn"></i>
    </div>
    <ul class="sidebar-links">
        <li><a href="/pages/dashboard/dashboard.html"><i class='bx bxs-dashboard'></i> Dashboard</a></li>
        <li><a href="/pages/cadastro.page/cadastro.html"><i class='bx bxs-user-plus'></i> Cadastro</a></li>
        <li>
            <details><summary><i class='bx bxs-dollar-circle'></i> Financeiro</summary>
                <ul><li><a href="/pages/financeiro.page/financeiro.html#lancamentos">- Lançamentos</a></li><li><a href="/pages/financeiro.page/financeiro.html#dizimos">- Dízimos e Ofertas</a></li></ul>
            </details>
        </li>
        <li>
            <details><summary><i class='bx bxs-box'></i> Utensílios</summary>
                <ul><li><a href="/pages/utensilios/utensilios.html#inventario">- Inventário</a></li><li><a href="/pages/utensilios/utensilios.html#emprestimos">- Empréstimos</a></li><li><a href="/pages/utensilios/utensilios.html#manutencao">- Manutenção</a></li></ul>
            </details>
        </li>
        <li>
            <details><summary><i class='bx bxs-calendar-event'></i> Agenda</summary>
                <ul><li><a href="/pages/agenda/agenda.html">- Calendário e Eventos</a></li></ul>
            </details>
        </li>
        <hr>
        <li><a href="/pages/configuracoes/configuracoes.html"><i class='bx bxs-cog'></i> Configurações</a></li>
        <li>
            <details>
                <summary><i class='bx bxs-info-circle'></i> Sobre</summary>
                <div class="sidebar-sobre">
                    <p><strong>Versão:</strong> 1.0.0</p>
                    <a href="#">Site do Desenvolvedor</a>
                </div>
            </details>
        </li>
    </ul>
</nav>
</header>

<main class="conteudo">
    <div class="header-pagina">
        <h2>Agenda e Eventos</h2>
        <div class="acoes-header">
            <div id="calendar-zoom-controls">
                <button id="btn-zoom-out" class="btn btn-secundario">-</button>
                <button id="btn-zoom-in" class="btn btn-secundario">+</button>
            </div>
            <button id="btn-novo-evento" class="btn btn-principal">
                <i class='bx bx-plus'></i> Novo Lançamento
            </button>
        </div>
    </div>

    <div class="container-abas">
        <div class="abas-links">
            <button id="tab-calendario" class="aba-link active">Calendário</button>
            <button id="tab-lista" class="aba-link">Lista</button>
        </div>
        <div class="abas-conteudo-wrapper">
            <div id="view-calendario" class="aba-conteudo active">
                <div id="calendario"></div>
            </div>
            <div id="view-lista" class="aba-conteudo">
                <div id="lista-eventos-container"></div>
            </div>
        </div>
    </div>
</main>

<div id="evento-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modal-title">Novo Evento</h2>
            <button class="modal-close">&times;</button>
        </div>
        <form id="evento-form">
            <input type="hidden" id="evento-id">
            <div class="form-group">
                <label for="evento-tipo">Tipo</label>
                <select id="evento-tipo" required>
                    <option value="Evento">Evento</option>
                    <option value="Programação">Programação</option>
                </select>
            </div>
            <div class="form-group">
                <label for="evento-nome">Nome</label>
                <input type="text" id="evento-nome" required>
            </div>
            <div class="form-group">
                <label for="evento-categoria">Categoria</label>
                <select id="evento-categoria" required>
                    <option value="">Carregando...</option>
                </select>
            </div>
            <div class="form-group">
                <label for="evento-recorrencia">Recorrência (se aplicável)</label>
                <input type="text" id="evento-recorrencia" placeholder="Ex: Toda quinta-feira às 20h">
            </div>
            <div class="form-group-grid">
                <div class="form-group">
                    <label for="evento-data-inicio">Data de Início</label>
                    <input type="datetime-local" id="evento-data-inicio" required>
                </div>
                <div class="form-group">
                    <label for="evento-data-fim">Data de Fim</label>
                    <input type="datetime-local" id="evento-data-fim" required>
                </div>
            </div>
            <div class="form-group">
                <label for="evento-local">Local</label>
                <input type="text" id="evento-local" required>
            </div>
            <div class="form-group">
                <label for="evento-responsavel">Responsável</label>
                <select id="evento-responsavel" required>
                    <option value="">Carregando...</option>
                </select>
            </div>
                            <div class="form-group">
                                <label for="evento-descricao">Descrição</label>
                                <textarea id="evento-descricao" rows="3"></textarea>
                            </div>
            
                            <!-- NOVO: Campos Financeiros para Eventos -->
                            <div id="financial-fields" style="display: none; border-top: 1px solid var(--cor-borda); padding-top: 15px; margin-top: 15px;">
                                <h4><i class='bx bxs-dollar-circle'></i> Gestão Financeira do Evento</h4>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="evento-envolve-fundos">
                                        Este evento envolve arrecadação de fundos ou tem custos?
                                    </label>
                                </div>
                                <div class="form-group-grid">
                                    <div class="form-group">
                                        <label for="evento-meta">Meta de Arrecadação (R$)</label>
                                        <input type="number" id="evento-meta" step="0.01" placeholder="2500.00">
                                    </div>
                                    <div class="form-group">
                                        <label for="evento-custo">Custo Estimado (R$)</label>
                                        <input type="number" id="evento-custo" step="0.01" placeholder="750.00">
                                    </div>
                                </div>
                            </div>
            
                            <div class="form-group">
                                <label for="evento-cartaz">Cartaz do Evento/Programação</label>
                                <input type="file" id="evento-cartaz-input" accept="image/*">
                                <input type="hidden" id="evento-cartaz-url">
                                <img id="cartaz-preview" src="" alt="Pré-visualização do cartaz" style="max-width: 100%; margin-top: 10px; display: none;">
                            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secundario modal-cancel">Cancelar</button>
                <button type="submit" class="btn btn-principal">Salvar</button>
            </div>
        </form>
    </div>
</div>

<!-- Scripts no final do body -->
<script src="/pages/config.js"></script>
<script src="/components/menu.js"></script>
<script src="agenda.js"></script>

</body>
</html>