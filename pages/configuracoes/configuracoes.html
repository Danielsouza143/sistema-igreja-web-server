<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurações - Gestão ADTC</title>
    <script src="/auth-guard.js"></script> <!-- GUARDA DE ROTA -->
    
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    
    <link rel="stylesheet" href="configuracoes.css">
    <link rel="stylesheet" href="/pages/styles/global.css"> 
    <link rel="stylesheet" href="/components/menu.css">
</head>
<body data-theme="light">
    <header id="menu-placeholder">
        <nav class="menu">
            <div class="menu-lado-esquerdo">
                <div class="hamburger-menu hamburger-mobile" id="hamburger-btn-mobile"><i class='bx bx-menu'></i></div>
                <img src="/pages/logo.tab.png" alt="logo-tab" width="65" class="menu-logo" id="menu-logo-img" />
                <h3 id="menu-church-name">ADTC - Tabernáculo Celeste</h3>
            </div>
            <div class="menu-acoes">
                <div class="notificacao-container" id="notificacao-container"><i class='bx bxs-bell'></i><span class="notificacao-contador" id="notificacao-contador"></span></div>
                <div class="conta-area" id="conta-area-trigger">
                    <div id="user-avatar" class="user-avatar">U</div>
                </div>
            </div>
        </nav>
        <aside class="sub-menu">
            <div class="hamburger-menu hamburger-desktop" id="hamburger-btn-desktop"><i class='bx bx-menu'></i></div>
            <div class="menu-categorias">
                <a href="/pages/dashboard/dashboard.html" class="sub-menu-link">Dashboard</a>
                <a href="/pages/cadastro.page/cadastro.html" class="sub-menu-link">Cadastro</a>
                <a href="/pages/lista.membros/lista.membros.html" class="sub-menu-link">Membros</a>
                <a href="/pages/financeiro.page/financeiro.html" class="sub-menu-link">Financeiro</a>
                <a href="/pages/utensilios/utensilios.html" class="sub-menu-link">Utensílios</a>
                <a href="/pages/eventos/eventos.html" class="sub-menu-link">Eventos</a>
            </div>
        </aside>
        <div id="sidebar-overlay" class="sidebar-overlay"></div>
        <nav id="sidebar-menu" class="sidebar">
            <div class="sidebar-header">
                <h4>Navegação Principal</h4>
                <i class='bx bx-x' id="sidebar-close-btn"></i>
            </div>
            <ul class="sidebar-links">
                <li><a href="/pages/dashboard/dashboard.html"><i class='bx bxs-dashboard'></i> Dashboard</a></li>
                <li>
                    <details><summary><i class='bx bxs-user-plus'></i> Cadastros</summary>
                        <ul>
                            <li><a href="/pages/cadastro.page/cadastro.html">- Central de Cadastros</a></li>
                            <li><a href="/pages/cadastro.membro.page/cadastro.membro.html">- Novo Membro</a></li>
                            <li><a href="/pages/cadastro.page/visitantes.html">- Visitantes</a></li>
                        </ul>
                    </details>
                </li>
                <li>
                    <details><summary><i class='bx bxs-group'></i> Membros</summary>
                        <ul><li><a href="/pages/lista.membros/lista.membros.html#lista">- Lista de Membros</a></li><li><a href="/pages/lista.membros/lista.membros.html#presenca">- Controle de Presença</a></li></ul>
                    </details>
                </li>
                <li>
                    <details><summary><i class='bx bxs-dollar-circle'></i> Financeiro</summary>
                        <ul><li><a href="/pages/financeiro.page/financeiro.html#lancamentos">- Lançamentos</a></li><li><a href="/pages/financeiro.page/financeiro.html#dizimos">- Dízimos e Ofertas</a></li></ul>
                    </details>
                </li>
                <li>
                    <details><summary><i class='bx bxs-home-heart'></i> Pequenos Grupos</summary>
                        <ul><li><a href="/pages/pequenos-grupos/pequenos-grupos.html#painel-grupos">- Painel de Grupos</a></li><li><a href="/pages/pequenos-grupos/pequenos-grupos.html#analise-geral">- Análise Geral</a></li></ul>
                    </details>
                </li>
                <li>
                    <details><summary><i class='bx bxs-box'></i> Utensílios</summary>
                        <ul><li><a href="/pages/utensilios/utensilios.html#inventario">- Inventário</a></li><li><a href="/pages/utensilios/utensilios.html#emprestimos">- Empréstimos</a></li><li><a href="/pages/utensilios/utensilios.html#manutencao">- Manutenção</a></li></ul>
                    </details>
                </li>
                <li>
                    <details><summary><i class='bx bxs-calendar-event'></i> Eventos</summary>
                        <ul><li><a href="/pages/eventos/eventos.html#painel">- Painel de Eventos</a></li></ul>
                    </details>
                </li>
                <hr>
                <li><a href="/pages/configuracoes/configuracoes.html"><i class='bx bxs-cog'></i> Configurações</a></li>
                <li>
                    <details><summary><i class='bx bxs-info-circle'></i> Sobre</summary>
                        <div class="sidebar-sobre"><p><strong>Versão:</strong> 1.0.0</p><a href="#" target="_blank">Site do Desenvolvedor</a></div>
                    </details>
                </li>
            </ul>
        </nav>
    </header>

    <main class="conteudo">
        <div class="config-container">
            <aside class="config-nav">
                <ul>
                    <li><a href="#perfil" class="config-nav-link active"><i class='bx bxs-user-circle'></i> Meu Perfil</a></li>
                    <li><a href="#aparencia" class="config-nav-link"><i class='bx bxs-palette'></i> Aparência</a></li>
                    <li><a href="#identidade" class="config-nav-link"><i class='bx bxs-church'></i> Identidade da Igreja</a></li>
                    <li><a href="#usuarios" class="config-nav-link"><i class='bx bxs-user-account'></i> Gerenciar Usuários</a></li>
                    <li><a href="#categorias" class="config-nav-link"><i class='bx bxs-category'></i> Categorias</a></li>
                    <li><a href="#backup" class="config-nav-link"><i class='bx bxs-data'></i> Backup e Restauração</a></li>
                    <li><a href="#logs" class="config-nav-link"><i class='bx bx-history'></i> Logs do Sistema</a></li>
                </ul>
            </aside>

            <div class="config-content">
                <!-- Seção: Meu Perfil -->
                <section id="perfil" class="config-section active">
                    <h1 class="title-page">Meu Perfil</h1>
                    <form id="form-perfil">
                        <div class="config-card">
                            <h3><i class='bx bx-user-circle'></i> Informações do Usuário</h3>
                            <div class="form-group">
                                <label for="perfil-nome-completo">Nome Completo</label>
                                <input type="text" id="perfil-nome-completo">
                            </div>
                            <div class="form-group">
                                <label for="perfil-username">Nome de Usuário (Login)</label>
                                <input type="text" id="perfil-username" readonly>
                            </div>
                            <button type="submit" class="btn-principal" id="btn-salvar-perfil">Salvar Nome</button>
                        </div>
                        <div class="config-card">
                            <h3><i class='bx bx-key'></i> Alterar Senha</h3>
                            <div class="form-group"><label for="perfil-senha-atual">Senha Atual</label><input type="password" id="perfil-senha-atual" placeholder="••••••••"></div>
                            <div class="form-group"><label for="perfil-nova-senha">Nova Senha</label><input type="password" id="perfil-nova-senha" placeholder="••••••••"></div>
                            <div class="form-group"><label for="perfil-confirmar-senha">Confirmar Nova Senha</label><input type="password" id="perfil-confirmar-senha" placeholder="••••••••"></div>
                            <button type="button" id="btn-salvar-senha" class="btn-principal">Salvar Nova Senha</button>
                        </div>
                    </form>
                </section>

                <!-- Seção: Aparência -->
                <section id="aparencia" class="config-section">
                    <h1 class="title-page">Aparência</h1>
                    <div class="config-card">
                        <h3><i class='bx bx-palette'></i> Personalização da Interface</h3>
                        <div class="form-group">
                            <label>Tema da Interface</label>
                            <div class="theme-switcher">
                                <button data-theme="light" class="theme-btn active">Claro</button>
                                <button data-theme="dark" class="theme-btn">Escuro</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="cor-principal">Cor Principal</label>
                            <input type="color" id="cor-principal" value="#001f5d">
                        </div>
                    </div>
                </section>

                <!-- Seção: Identidade da Igreja -->
                <section id="identidade" class="config-section">
                    <h1 class="title-page">Identidade da Igreja</h1>
                    <div class="config-card">
                        <h3><i class='bx bxs-church'></i> Nome e Logo</h3>
                        <div class="form-group">
                            <label for="config-nome-igreja">Nome da Igreja</label>
                            <input type="text" id="config-nome-igreja" placeholder="Nome completo da sua igreja">
                        </div>
                        <div class="form-group">
                            <label>Logo da Igreja</label>
                            <div class="logo-preview-container">
                                <img id="logo-preview" src="/pages/logo.tab.png" alt="Pré-visualização do logo">
                            </div>
                            <input type="file" id="logo-upload-input" accept="image/png, image/jpeg" style="display: none;">
                            <button id="btn-trocar-logo" class="btn-secundario">Trocar Logo</button>
                        </div>
                        <button id="btn-salvar-identidade" class="btn-principal">Salvar Identidade</button>
                    </div>
                </section>

                <!-- Seção: Gerenciar Usuários -->
                <section id="usuarios" class="config-section">
                    <h1 class="title-page">Gerenciamento de Usuários</h1>
                    <div class="config-card full-width">
                        <p>Adicione, edite ou remova usuários que podem acessar o sistema.</p>
                        <div class="header-actions">
                            <button id="btn-novo-usuario" class="btn-principal"><i class='bx bx-plus'></i> Adicionar Usuário</button>
                        </div>
                        <ul id="lista-usuarios" class="lista-configs"></ul>
                    </div>
                </section>

                <!-- Seção: Categorias -->
                <section id="categorias" class="config-section">
                    <h1 class="title-page">Central de Categorias</h1>
                    <div id="categorias-container" class="config-card full-width">
                        <div class="categorias-container">
                            <div class="categoria-coluna">
                                <h4><i class='bx bxs-coffee-togo'></i> Utensílios</h4>
                                <ul id="lista-cat-utensilios" class="lista-configs"></ul>
                                <div class="add-config-form"><input type="text" id="nova-cat-utensilios_categorias" placeholder="Nova categoria"><button data-tipo="utensilios_categorias" class="btn-add-categoria btn-principal">Adicionar</button></div>
                            </div>
                            <div class="categoria-coluna">
                                <h4><i class='bx bxs-calendar-event'></i> Eventos</h4>
                                <ul id="lista-cat-eventos" class="lista-configs"></ul>
                                <div class="add-config-form"><input type="text" id="nova-cat-eventos_categorias" placeholder="Nova categoria"><button data-tipo="eventos_categorias" class="btn-add-categoria btn-principal">Adicionar</button></div>
                            </div>
                            <div class="categoria-coluna">
                                <h4><i class='bx bxs-dollar-circle'></i> Financeiro (Entradas)</h4>
                                <ul id="lista-cat-entradas" class="lista-configs"></ul>
                                <div class="add-config-form"><input type="text" id="nova-cat-entradas" placeholder="Nova categoria"><button data-tipo="financeiro_categorias" data-subtipo="entradas" class="btn-add-categoria btn-principal">Adicionar</button></div>
                            </div>
                            <div class="categoria-coluna">
                                <h4><i class='bx bxs-dollar-circle'></i> Financeiro (Saídas)</h4>
                                <ul id="lista-cat-saidas" class="lista-configs"></ul>
                                <div class="add-config-form"><input type="text" id="nova-cat-saidas" placeholder="Nova categoria"><button data-tipo="financeiro_categorias" data-subtipo="saidas" class="btn-add-categoria btn-principal">Adicionar</button></div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Seção: Backup e Restauração -->
                <section id="backup" class="config-section">
                    <h1 class="title-page">Backup e Restauração</h1>
                    <div class="config-card">
                        <h3><i class='bx bx-data'></i> Cópia de Segurança</h3>
                        <p>Salve todos os dados do sistema em um arquivo seguro ou restaure a partir de um backup anterior.</p>
                        <div class="backup-actions">
                            <button id="btn-exportar-dados" class="btn-principal">Exportar Dados (Backup)</button>
                            <button id="btn-importar-dados" class="btn-secundario">Importar Dados (Restaurar)</button>
                            <input type="file" id="import-file-input" style="display: none;" accept=".json">
                        </div>
                    </div>
                </section>

                <!-- Seção: Logs do Sistema -->
                <section id="logs" class="config-section">
                    <h1 class="title-page">Log de Atividades do Sistema</h1>
                    <div class="config-card full-width">
                        <p>Últimas 200 ações realizadas no sistema. Apenas administradores podem ver esta seção.</p>
                        <div id="log-container">
                            <ul id="lista-logs" class="lista-configs">
                                <li class="mensagem-vazio">Carregando logs...</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal para Usuários -->
    <div id="modal-usuario" class="modal-overlay">
        <div class="modal-content">
            <form id="form-usuario">
                <h2 id="modal-usuario-titulo">Adicionar Usuário</h2>
                <input type="hidden" id="usuario-id">
                <div class="form-group"><label for="usuario-nome-completo">Nome Completo</label><input type="text" id="usuario-nome-completo"></div>
                <div class="form-group"><label for="usuario-username">Nome de Usuário</label><input type="text" id="usuario-username" required></div>
                <div class="form-group"><label for="usuario-password">Senha</label><input type="password" id="usuario-password" placeholder="Deixe em branco para não alterar"></div>
                <div class="form-group"><label for="usuario-role">Permissão</label>
                    <select id="usuario-role" required><option value="operador">Operador</option><option value="admin">Administrador</option></select>
                </div>
                <div class="modal-actions"><button type="button" class="btn-secundario" data-close-modal="modal-usuario">Cancelar</button><button type="submit" class="btn-principal">Salvar</button></div>
            </form>
        </div>
    </div>

    <!-- Modal da Conta do Usuário (para ser usado em todas as páginas) -->
    <div id="modal-conta-usuario" class="modal-overlay">
        <div class="modal-content modal-sm">
            <button class="modal-close" data-close-modal="modal-conta-usuario">&times;</button>
            <div class="conta-modal-header">
                <div id="conta-modal-avatar" class="user-avatar-large">U</div>
                <h3 id="conta-modal-nome">Nome do Usuário</h3>
                <p id="conta-modal-email">email@exemplo.com</p>
                <span id="conta-modal-role" class="badge">Administrador</span>
            </div>
            <div class="conta-modal-body">
                <a href="/pages/configuracoes/configuracoes.html#perfil" class="btn-modal-conta"><i class='bx bxs-user-cog'></i> Gerenciar Perfil</a>
                <a href="#" id="btn-modal-logout" class="btn-modal-conta btn-perigo"><i class='bx bx-log-out'></i> Sair</a>
            </div>
        </div>
    </div>


    <script src="/pages/config.js"></script>
    <script src="configuracoes.js"></script>
    <script src="/components/menu.js"></script>
</body>
</html>
